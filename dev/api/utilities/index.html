<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Utility Functions · StochasticGene.jl</title><meta name="title" content="Utility Functions · StochasticGene.jl"/><meta property="og:title" content="Utility Functions · StochasticGene.jl"/><meta property="twitter:title" content="Utility Functions · StochasticGene.jl"/><meta name="description" content="Documentation for StochasticGene.jl."/><meta property="og:description" content="Documentation for StochasticGene.jl."/><meta property="twitter:description" content="Documentation for StochasticGene.jl."/><meta property="og:url" content="https://nih-niddk-mbs.github.io/StochasticGene.jl/stable/api/utilities/"/><meta property="twitter:url" content="https://nih-niddk-mbs.github.io/StochasticGene.jl/stable/api/utilities/"/><link rel="canonical" href="https://nih-niddk-mbs.github.io/StochasticGene.jl/stable/api/utilities/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXXX-X"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-XXXXXXXXX-X', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">StochasticGene.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/basic_telegraph/">Basic Telegraph Model</a></li><li><a class="tocitem" href="../../examples/multi_state_rna/">Multi-State Model</a></li><li><a class="tocitem" href="../../examples/rna_histogram/">RNA Histogram Analysis</a></li><li><a class="tocitem" href="../../examples/ms2_analysis/">MS2 Reporter Analysis</a></li><li><a class="tocitem" href="../../examples/dual_reporter/">Dual Reporter System</a></li><li><a class="tocitem" href="../../examples/trace_analysis/">Trace Analysis</a></li><li><a class="tocitem" href="../../examples/dwell_time_analysis/">Basic Dwell Times</a></li><li><a class="tocitem" href="../../examples/rna_dwell_time/">RNA Dwell Time Analysis</a></li><li><a class="tocitem" href="../../examples/rna_onoff/">RNA On-Off Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/parallel_processing/">Parallel Processing</a></li><li><a class="tocitem" href="../../examples/hierarchical_trace/">Hierarchical Trace Analysis</a></li><li><a class="tocitem" href="../../examples/joint_trace/">Joint Trace Analysis</a></li><li><a class="tocitem" href="../../examples/coupled_models/">Coupled Model Analysis</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../">API Reference</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Core Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../fit/">Model Fitting</a></li><li><a class="tocitem" href="../simulator/">Model Simulation</a></li><li><a class="tocitem" href="../load_data/">Data Loading</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox" checked/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Function Libraries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Utility Functions</a><ul class="internal"><li><a class="tocitem" href="#Data-Processing-Functions"><span>Data Processing Functions</span></a></li><li><a class="tocitem" href="#Model-Construction-Functions"><span>Model Construction Functions</span></a></li><li><a class="tocitem" href="#Statistical-Functions"><span>Statistical Functions</span></a></li><li><a class="tocitem" href="#File-I/O-Functions"><span>File I/O Functions</span></a></li><li><a class="tocitem" href="#Advanced-Utility-Functions"><span>Advanced Utility Functions</span></a></li><li><a class="tocitem" href="#Model-Analysis-Functions"><span>Model Analysis Functions</span></a></li><li><a class="tocitem" href="#Performance-Utilities"><span>Performance Utilities</span></a></li><li><a class="tocitem" href="#Usage-Examples"><span>Usage Examples</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../analysis/">Analysis Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-4" type="checkbox"/><label class="tocitem" for="menuitem-5-4"><span class="docs-label">Output Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../write_traces/">Write Traces</a></li><li><a class="tocitem" href="../write_ONOFFhistograms/">Write ON/OFF Histograms</a></li><li><a class="tocitem" href="../write_residency_G_folder/">Write G State Residency</a></li></ul></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons visible"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"><option value="#" selected="selected">1.6.0</option></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Function Libraries</a></li><li class="is-active"><a href>Utility Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Utility Functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nih-niddk-mbs/StochasticGene.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nih-niddk-mbs/StochasticGene.jl/blob/main/docs/src/api/utilities.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Utility-Functions"><a class="docs-heading-anchor" href="#Utility-Functions">Utility Functions</a><a id="Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Functions" title="Permalink"></a></h1><p>Collection of utility functions for data processing, model construction, and analysis.</p><h2 id="Data-Processing-Functions"><a class="docs-heading-anchor" href="#Data-Processing-Functions">Data Processing Functions</a><a id="Data-Processing-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Processing-Functions" title="Permalink"></a></h2><h3 id="normalize_histogram"><a class="docs-heading-anchor" href="#normalize_histogram">normalize_histogram</a><a id="normalize_histogram-1"></a><a class="docs-heading-anchor-permalink" href="#normalize_histogram" title="Permalink"></a></h3><pre><code class="language-julia hljs">normalize_histogram(histogram::Vector{Float64}) -&gt; Vector{Float64}</code></pre><p>Normalize a histogram to create a probability distribution.</p><p><strong>Arguments:</strong></p><ul><li><code>histogram</code>: Vector of histogram counts</li></ul><p><strong>Returns:</strong></p><ul><li>Normalized probability distribution (sums to 1.0)</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Normalize RNA count histogram
raw_counts = [100, 150, 200, 120, 80, 50]
prob_dist = normalize_histogram(raw_counts)
println(&quot;Sum: &quot;, sum(prob_dist))  # Should be 1.0</code></pre><h3 id="make_array"><a class="docs-heading-anchor" href="#make_array">make_array</a><a id="make_array-1"></a><a class="docs-heading-anchor-permalink" href="#make_array" title="Permalink"></a></h3><pre><code class="language-julia hljs">make_array(data) -&gt; Array</code></pre><p>Convert various data types to arrays for processing.</p><p><strong>Arguments:</strong></p><ul><li><code>data</code>: Data to convert (Vector, DataFrame, etc.)</li></ul><p><strong>Returns:</strong></p><ul><li>Array representation of the data</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Convert DataFrame column to array
df = DataFrame(counts = [1, 2, 3, 4, 5])
arr = make_array(df.counts)</code></pre><h3 id="make_mat"><a class="docs-heading-anchor" href="#make_mat">make_mat</a><a id="make_mat-1"></a><a class="docs-heading-anchor-permalink" href="#make_mat" title="Permalink"></a></h3><pre><code class="language-julia hljs">make_mat(data) -&gt; Matrix</code></pre><p>Convert data to matrix format for analysis.</p><p><strong>Arguments:</strong></p><ul><li><code>data</code>: Data to convert</li></ul><p><strong>Returns:</strong></p><ul><li>Matrix representation of the data</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Convert vector of vectors to matrix
traces = [[1.0, 2.0, 3.0], [2.0, 3.0, 4.0]]
mat = make_mat(traces)</code></pre><h3 id="digit_vector"><a class="docs-heading-anchor" href="#digit_vector">digit_vector</a><a id="digit_vector-1"></a><a class="docs-heading-anchor-permalink" href="#digit_vector" title="Permalink"></a></h3><pre><code class="language-julia hljs">digit_vector(number::Int, base::Int=10) -&gt; Vector{Int}</code></pre><p>Convert a number to a vector of digits in specified base.</p><p><strong>Arguments:</strong></p><ul><li><code>number</code>: Number to convert</li><li><code>base</code>: Base for conversion (default: 10)</li></ul><p><strong>Returns:</strong></p><ul><li>Vector of digits</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Convert number to digits
digits = digit_vector(12345)  # [1, 2, 3, 4, 5]
binary = digit_vector(10, 2)  # [1, 0, 1, 0]</code></pre><h2 id="Model-Construction-Functions"><a class="docs-heading-anchor" href="#Model-Construction-Functions">Model Construction Functions</a><a id="Model-Construction-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Construction-Functions" title="Permalink"></a></h2><h3 id="prepare_rates"><a class="docs-heading-anchor" href="#prepare_rates">prepare_rates</a><a id="prepare_rates-1"></a><a class="docs-heading-anchor-permalink" href="#prepare_rates" title="Permalink"></a></h3><pre><code class="language-julia hljs">prepare_rates(rates::Vector{Float64}, model::AbstractModel) -&gt; Vector{Float64}</code></pre><p>Prepare rate parameters for model fitting by applying transformations.</p><p><strong>Arguments:</strong></p><ul><li><code>rates</code>: Raw rate parameters</li><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>Transformed rates ready for fitting</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Prepare rates for fitting
raw_rates = [0.1, 0.2, 0.3]
prepared = prepare_rates(raw_rates, model)</code></pre><h3 id="get_rates"><a class="docs-heading-anchor" href="#get_rates">get_rates</a><a id="get_rates-1"></a><a class="docs-heading-anchor-permalink" href="#get_rates" title="Permalink"></a></h3><pre><code class="language-julia hljs">get_rates(parameters::Vector{Float64}, model::AbstractModel, log_scale::Bool=true) -&gt; Vector{Float64}</code></pre><p>Extract rate parameters from fitted parameters.</p><p><strong>Arguments:</strong></p><ul><li><code>parameters</code>: Fitted parameter vector</li><li><code>model</code>: Model structure</li><li><code>log_scale</code>: Whether parameters are in log scale</li></ul><p><strong>Returns:</strong></p><ul><li>Rate parameters</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Extract rates from fitted parameters
fitted_params = [log(0.1), log(0.2), log(0.3)]
rates = get_rates(fitted_params, model, true)</code></pre><h3 id="get_param"><a class="docs-heading-anchor" href="#get_param">get_param</a><a id="get_param-1"></a><a class="docs-heading-anchor-permalink" href="#get_param" title="Permalink"></a></h3><pre><code class="language-julia hljs">get_param(parameters::Vector{Float64}, model::AbstractModel, param_type::String) -&gt; Vector{Float64}</code></pre><p>Extract specific parameter types from fitted parameters.</p><p><strong>Arguments:</strong></p><ul><li><code>parameters</code>: Fitted parameter vector</li><li><code>model</code>: Model structure</li><li><code>param_type</code>: Type of parameters to extract (&quot;rates&quot;, &quot;noise&quot;, &quot;coupling&quot;)</li></ul><p><strong>Returns:</strong></p><ul><li>Requested parameters</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Extract noise parameters
noise_params = get_param(fitted_params, model, &quot;noise&quot;)</code></pre><h3 id="num_rates"><a class="docs-heading-anchor" href="#num_rates">num_rates</a><a id="num_rates-1"></a><a class="docs-heading-anchor-permalink" href="#num_rates" title="Permalink"></a></h3><pre><code class="language-julia hljs">num_rates(transitions::Tuple, R::Int, S::Int, insertstep::Int) -&gt; Int</code></pre><p>Count the number of transition rates in a model.</p><p><strong>Arguments:</strong></p><ul><li><code>transitions</code>: Model transitions</li><li><code>R</code>: Number of pre-RNA steps</li><li><code>S</code>: Number of splice sites</li><li><code>insertstep</code>: Reporter insertion step</li></ul><p><strong>Returns:</strong></p><ul><li>Total number of rates</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Count rates for a GRS model
n_rates = num_rates(([1,2], [2,1]), 3, 2, 1)</code></pre><h3 id="num*all*parameters"><a class="docs-heading-anchor" href="#num*all*parameters">num<em>all</em>parameters</a><a id="num*all*parameters-1"></a><a class="docs-heading-anchor-permalink" href="#num*all*parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">num_all_parameters(transitions::Tuple, R::Int, S::Int, insertstep::Int, 
                  reporter, coupling::Tuple, grid) -&gt; Int</code></pre><p>Count total parameters including rates, noise, coupling, and grid parameters.</p><p><strong>Arguments:</strong></p><ul><li><code>transitions</code>: Model transitions</li><li><code>R</code>, <code>S</code>, <code>insertstep</code>: Model structure</li><li><code>reporter</code>: Reporter configuration</li><li><code>coupling</code>: Coupling specification</li><li><code>grid</code>: Grid specification</li></ul><p><strong>Returns:</strong></p><ul><li>Total parameter count</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Count all parameters
n_total = num_all_parameters(transitions, 2, 1, 1, reporter, coupling, grid)</code></pre><h2 id="Statistical-Functions"><a class="docs-heading-anchor" href="#Statistical-Functions">Statistical Functions</a><a id="Statistical-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Statistical-Functions" title="Permalink"></a></h2><h3 id="prob_Gaussian"><a class="docs-heading-anchor" href="#prob_Gaussian">prob_Gaussian</a><a id="prob_Gaussian-1"></a><a class="docs-heading-anchor-permalink" href="#prob_Gaussian" title="Permalink"></a></h3><pre><code class="language-julia hljs">prob_Gaussian(y::Float64, μ::Float64, σ::Float64) -&gt; Float64</code></pre><p>Calculate Gaussian probability density.</p><p><strong>Arguments:</strong></p><ul><li><code>y</code>: Observed value</li><li><code>μ</code>: Mean</li><li><code>σ</code>: Standard deviation</li></ul><p><strong>Returns:</strong></p><ul><li>Probability density</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Calculate Gaussian probability
prob = prob_Gaussian(2.0, 1.5, 0.5)</code></pre><h3 id="prob*Gaussian*grid"><a class="docs-heading-anchor" href="#prob*Gaussian*grid">prob<em>Gaussian</em>grid</a><a id="prob*Gaussian*grid-1"></a><a class="docs-heading-anchor-permalink" href="#prob*Gaussian*grid" title="Permalink"></a></h3><pre><code class="language-julia hljs">prob_Gaussian_grid(y::Vector{Float64}, μ::Vector{Float64}, σ::Vector{Float64}) -&gt; Vector{Float64}</code></pre><p>Calculate Gaussian probabilities on a grid.</p><p><strong>Arguments:</strong></p><ul><li><code>y</code>: Observed values</li><li><code>μ</code>: Mean values</li><li><code>σ</code>: Standard deviations</li></ul><p><strong>Returns:</strong></p><ul><li>Vector of probabilities</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Calculate probabilities on grid
y_vals = [1.0, 2.0, 3.0]
mu_vals = [1.1, 2.1, 2.9]
sigma_vals = [0.2, 0.3, 0.4]
probs = prob_Gaussian_grid(y_vals, mu_vals, sigma_vals)</code></pre><h3 id="mean_elongationtime"><a class="docs-heading-anchor" href="#mean_elongationtime">mean_elongationtime</a><a id="mean_elongationtime-1"></a><a class="docs-heading-anchor-permalink" href="#mean_elongationtime" title="Permalink"></a></h3><pre><code class="language-julia hljs">mean_elongationtime(rates::Vector{Float64}, R::Int) -&gt; Float64</code></pre><p>Calculate mean elongation time for pre-RNA steps.</p><p><strong>Arguments:</strong></p><ul><li><code>rates</code>: Rate parameters</li><li><code>R</code>: Number of pre-RNA steps</li></ul><p><strong>Returns:</strong></p><ul><li>Mean elongation time</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Calculate elongation time
rates = [0.1, 0.2, 0.3, 0.4]
elong_time = mean_elongationtime(rates, 2)</code></pre><h3 id="on_states"><a class="docs-heading-anchor" href="#on_states">on_states</a><a id="on_states-1"></a><a class="docs-heading-anchor-permalink" href="#on_states" title="Permalink"></a></h3><pre><code class="language-julia hljs">on_states(G::Int, R::Int, S::Int, insertstep::Int) -&gt; Vector{Int}</code></pre><p>Identify transcriptionally active states.</p><p><strong>Arguments:</strong></p><ul><li><code>G</code>: Number of gene states</li><li><code>R</code>: Number of pre-RNA steps</li><li><code>S</code>: Number of splice sites</li><li><code>insertstep</code>: Reporter insertion step</li></ul><p><strong>Returns:</strong></p><ul><li>Vector of active state indices</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Find active states
active = on_states(2, 3, 1, 1)</code></pre><h3 id="source_states"><a class="docs-heading-anchor" href="#source_states">source_states</a><a id="source_states-1"></a><a class="docs-heading-anchor-permalink" href="#source_states" title="Permalink"></a></h3><pre><code class="language-julia hljs">source_states(transitions::Tuple) -&gt; Vector{Int}</code></pre><p>Identify source states for transitions.</p><p><strong>Arguments:</strong></p><ul><li><code>transitions</code>: Model transitions</li></ul><p><strong>Returns:</strong></p><ul><li>Vector of source state indices</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Find source states
sources = source_states(([1,2], [2,1]))</code></pre><h2 id="File-I/O-Functions"><a class="docs-heading-anchor" href="#File-I/O-Functions">File I/O Functions</a><a id="File-I/O-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#File-I/O-Functions" title="Permalink"></a></h2><h3 id="folder_path"><a class="docs-heading-anchor" href="#folder_path">folder_path</a><a id="folder_path-1"></a><a class="docs-heading-anchor-permalink" href="#folder_path" title="Permalink"></a></h3><pre><code class="language-julia hljs">folder_path(folder::String, root::String=&quot;.&quot;, subfolder::String=&quot;&quot;; make::Bool=false) -&gt; String</code></pre><p>Construct folder paths with optional creation.</p><p><strong>Arguments:</strong></p><ul><li><code>folder</code>: Folder name</li><li><code>root</code>: Root directory</li><li><code>subfolder</code>: Subfolder name</li><li><code>make</code>: Whether to create the folder</li></ul><p><strong>Returns:</strong></p><ul><li>Full folder path</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Create results folder path
results_path = folder_path(&quot;results&quot;, &quot;.&quot;, &quot;analysis&quot;, make=true)</code></pre><h3 id="folder_setup"><a class="docs-heading-anchor" href="#folder_setup">folder_setup</a><a id="folder_setup-1"></a><a class="docs-heading-anchor-permalink" href="#folder_setup" title="Permalink"></a></h3><pre><code class="language-julia hljs">folder_setup(base_path::String, folders::Vector{String}) -&gt; Nothing</code></pre><p>Set up directory structure for analysis.</p><p><strong>Arguments:</strong></p><ul><li><code>base_path</code>: Base directory</li><li><code>folders</code>: Vector of folder names to create</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Set up analysis folders
folder_setup(&quot;project&quot;, [&quot;data&quot;, &quot;results&quot;, &quot;figures&quot;])</code></pre><h3 id="datapdf"><a class="docs-heading-anchor" href="#datapdf">datapdf</a><a id="datapdf-1"></a><a class="docs-heading-anchor-permalink" href="#datapdf" title="Permalink"></a></h3><pre><code class="language-julia hljs">datapdf(data::AbstractExperimentalData, filename::String) -&gt; Nothing</code></pre><p>Generate PDF summary of data.</p><p><strong>Arguments:</strong></p><ul><li><code>data</code>: Data structure</li><li><code>filename</code>: Output filename</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Generate data summary PDF
datapdf(rna_data, &quot;data_summary.pdf&quot;)</code></pre><h3 id="make_dataframes"><a class="docs-heading-anchor" href="#make_dataframes">make_dataframes</a><a id="make_dataframes-1"></a><a class="docs-heading-anchor-permalink" href="#make_dataframes" title="Permalink"></a></h3><pre><code class="language-julia hljs">make_dataframes(results, model::AbstractModel) -&gt; DataFrame</code></pre><p>Create DataFrames from analysis results.</p><p><strong>Arguments:</strong></p><ul><li><code>results</code>: Analysis results</li><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>DataFrame with results</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Convert results to DataFrame
df = make_dataframes(fit_results, model)</code></pre><h3 id="write*dataframes*only"><a class="docs-heading-anchor" href="#write*dataframes*only">write<em>dataframes</em>only</a><a id="write*dataframes*only-1"></a><a class="docs-heading-anchor-permalink" href="#write*dataframes*only" title="Permalink"></a></h3><pre><code class="language-julia hljs">write_dataframes_only(dataframes::Vector{DataFrame}, folder::String, label::String) -&gt; Nothing</code></pre><p>Write DataFrames to CSV files.</p><p><strong>Arguments:</strong></p><ul><li><code>dataframes</code>: Vector of DataFrames</li><li><code>folder</code>: Output folder</li><li><code>label</code>: File label</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Write results to CSV
write_dataframes_only([df1, df2], &quot;results&quot;, &quot;analysis&quot;)</code></pre><h2 id="Advanced-Utility-Functions"><a class="docs-heading-anchor" href="#Advanced-Utility-Functions">Advanced Utility Functions</a><a id="Advanced-Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Utility-Functions" title="Permalink"></a></h2><h3 id="zero_median"><a class="docs-heading-anchor" href="#zero_median">zero_median</a><a id="zero_median-1"></a><a class="docs-heading-anchor-permalink" href="#zero_median" title="Permalink"></a></h3><pre><code class="language-julia hljs">zero_median(traces::Vector{Vector{Float64}}, zero::Bool) -&gt; Tuple{Vector{Vector{Float64}}, Vector{Float64}}</code></pre><p>Zero-center traces by subtracting median values.</p><p><strong>Arguments:</strong></p><ul><li><code>traces</code>: Vector of trace vectors</li><li><code>zero</code>: Whether to zero-center</li></ul><p><strong>Returns:</strong></p><ul><li>Tuple of (zero-centered traces, scale factors)</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Zero-center traces
centered_traces, scales = zero_median(traces, true)</code></pre><h3 id="fix"><a class="docs-heading-anchor" href="#fix">fix</a><a id="fix-1"></a><a class="docs-heading-anchor-permalink" href="#fix" title="Permalink"></a></h3><pre><code class="language-julia hljs">fix(parameters::Vector{Float64}, fixedeffects::Tuple) -&gt; Vector{Float64}</code></pre><p>Apply fixed effects to parameters.</p><p><strong>Arguments:</strong></p><ul><li><code>parameters</code>: Parameter vector</li><li><code>fixedeffects</code>: Fixed effects specification</li></ul><p><strong>Returns:</strong></p><ul><li>Parameters with fixed effects applied</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Apply fixed effects
fixed_params = fix(parameters, fixedeffects)</code></pre><h3 id="fix_filenames"><a class="docs-heading-anchor" href="#fix_filenames">fix_filenames</a><a id="fix_filenames-1"></a><a class="docs-heading-anchor-permalink" href="#fix_filenames" title="Permalink"></a></h3><pre><code class="language-julia hljs">fix_filenames(folder::String, pattern::String, replacement::String) -&gt; Nothing</code></pre><p>Fix filenames in a folder by pattern replacement.</p><p><strong>Arguments:</strong></p><ul><li><code>folder</code>: Folder path</li><li><code>pattern</code>: Pattern to replace</li><li><code>replacement</code>: Replacement string</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Fix filenames
fix_filenames(&quot;data&quot;, &quot;old_prefix&quot;, &quot;new_prefix&quot;)</code></pre><h2 id="Model-Analysis-Functions"><a class="docs-heading-anchor" href="#Model-Analysis-Functions">Model Analysis Functions</a><a id="Model-Analysis-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Analysis-Functions" title="Permalink"></a></h2><h3 id="large_deviance"><a class="docs-heading-anchor" href="#large_deviance">large_deviance</a><a id="large_deviance-1"></a><a class="docs-heading-anchor-permalink" href="#large_deviance" title="Permalink"></a></h3><pre><code class="language-julia hljs">large_deviance(chains::Vector, threshold::Float64=1000.0) -&gt; Vector{Int}</code></pre><p>Identify chains with unusually large deviance.</p><p><strong>Arguments:</strong></p><ul><li><code>chains</code>: MCMC chains</li><li><code>threshold</code>: Deviance threshold</li></ul><p><strong>Returns:</strong></p><ul><li>Indices of chains with large deviance</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Find problematic chains
bad_chains = large_deviance(mcmc_chains, 500.0)</code></pre><h3 id="large_rhat"><a class="docs-heading-anchor" href="#large_rhat">large_rhat</a><a id="large_rhat-1"></a><a class="docs-heading-anchor-permalink" href="#large_rhat" title="Permalink"></a></h3><pre><code class="language-julia hljs">large_rhat(stats, threshold::Float64=1.1) -&gt; Vector{Int}</code></pre><p>Identify parameters with large R-hat values.</p><p><strong>Arguments:</strong></p><ul><li><code>stats</code>: MCMC statistics</li><li><code>threshold</code>: R-hat threshold</li></ul><p><strong>Returns:</strong></p><ul><li>Indices of parameters with large R-hat</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Find non-converged parameters
unconverged = large_rhat(mcmc_stats, 1.05)</code></pre><h3 id="assemble*measures*model"><a class="docs-heading-anchor" href="#assemble*measures*model">assemble<em>measures</em>model</a><a id="assemble*measures*model-1"></a><a class="docs-heading-anchor-permalink" href="#assemble*measures*model" title="Permalink"></a></h3><pre><code class="language-julia hljs">assemble_measures_model(measures::Vector, model::AbstractModel) -&gt; Dict</code></pre><p>Assemble model measures for analysis.</p><p><strong>Arguments:</strong></p><ul><li><code>measures</code>: Vector of measure objects</li><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>Dictionary of assembled measures</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Assemble measures
assembled = assemble_measures_model(measures, model)</code></pre><h3 id="assemble_all"><a class="docs-heading-anchor" href="#assemble_all">assemble_all</a><a id="assemble_all-1"></a><a class="docs-heading-anchor-permalink" href="#assemble_all" title="Permalink"></a></h3><pre><code class="language-julia hljs">assemble_all(fits, stats, measures, model::AbstractModel) -&gt; Dict</code></pre><p>Assemble all analysis results.</p><p><strong>Arguments:</strong></p><ul><li><code>fits</code>: Fit results</li><li><code>stats</code>: Statistics</li><li><code>measures</code>: Measures</li><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>Dictionary of all results</li></ul><p><strong>Example:</strong></p><pre><code class="language-julia hljs"># Assemble all results
all_results = assemble_all(fits, stats, measures, model)</code></pre><h2 id="Performance-Utilities"><a class="docs-heading-anchor" href="#Performance-Utilities">Performance Utilities</a><a id="Performance-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Utilities" title="Permalink"></a></h2><h3 id="set_indices"><a class="docs-heading-anchor" href="#set_indices">set_indices</a><a id="set_indices-1"></a><a class="docs-heading-anchor-permalink" href="#set_indices" title="Permalink"></a></h3><pre><code class="language-julia hljs">set_indices(model::AbstractModel) -&gt; Vector{Int}</code></pre><p>Set parameter indices for efficient computation.</p><p><strong>Arguments:</strong></p><ul><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>Vector of parameter indices</li></ul><h3 id="T_dimension"><a class="docs-heading-anchor" href="#T_dimension">T_dimension</a><a id="T_dimension-1"></a><a class="docs-heading-anchor-permalink" href="#T_dimension" title="Permalink"></a></h3><pre><code class="language-julia hljs">T_dimension(model::AbstractModel) -&gt; Int</code></pre><p>Calculate transition matrix dimension.</p><p><strong>Arguments:</strong></p><ul><li><code>model</code>: Model structure</li></ul><p><strong>Returns:</strong></p><ul><li>Matrix dimension</li></ul><h3 id="sparse"><a class="docs-heading-anchor" href="#sparse">sparse</a><a id="sparse-1"></a><a class="docs-heading-anchor-permalink" href="#sparse" title="Permalink"></a></h3><pre><code class="language-julia hljs">sparse(data::Matrix) -&gt; SparseMatrixCSC</code></pre><p>Convert matrix to sparse format for efficiency.</p><p><strong>Arguments:</strong></p><ul><li><code>data</code>: Dense matrix</li></ul><p><strong>Returns:</strong></p><ul><li>Sparse matrix</li></ul><h2 id="Usage-Examples"><a class="docs-heading-anchor" href="#Usage-Examples">Usage Examples</a><a id="Usage-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Examples" title="Permalink"></a></h2><h3 id="Complete-Analysis-Pipeline"><a class="docs-heading-anchor" href="#Complete-Analysis-Pipeline">Complete Analysis Pipeline</a><a id="Complete-Analysis-Pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Analysis-Pipeline" title="Permalink"></a></h3><pre><code class="language-julia hljs">using StochasticGene

# Load and process data
data = load_data(&quot;rna&quot;, String[], &quot;data/&quot;, &quot;exp1&quot;, &quot;MYC&quot;, &quot;ctrl&quot;, (), 1)
normalized = normalize_histogram(data.histRNA)

# Set up model
rates = prepare_rates([0.1, 0.2], model)
n_params = num_all_parameters(transitions, 0, 0, 1, reporter, (), nothing)

# Analyze results
active_states = on_states(2, 0, 0, 1)
elong_time = mean_elongationtime(rates, 0)

# Output results
folder_setup(&quot;analysis&quot;, [&quot;results&quot;, &quot;figures&quot;])
results_path = folder_path(&quot;results&quot;, &quot;analysis&quot;, make=true)</code></pre><h3 id="Parameter-Extraction"><a class="docs-heading-anchor" href="#Parameter-Extraction">Parameter Extraction</a><a id="Parameter-Extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Extraction" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Extract different parameter types
all_rates = get_rates(fitted_params, model, true)
noise_params = get_param(fitted_params, model, &quot;noise&quot;)
coupling_params = get_param(fitted_params, model, &quot;coupling&quot;)

# Count parameters
n_rates = num_rates(transitions, 2, 1, 1)
n_total = num_all_parameters(transitions, 2, 1, 1, reporter, coupling, grid)</code></pre><h3 id="Data-Processing-Pipeline"><a class="docs-heading-anchor" href="#Data-Processing-Pipeline">Data Processing Pipeline</a><a id="Data-Processing-Pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Processing-Pipeline" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Process trace data
traces, scales = zero_median(raw_traces, true)
trace_matrix = make_mat(traces)
normalized_traces = normalize_histogram.(traces)

# Statistical analysis
probs = [prob_Gaussian(t, μ, σ) for t in trace_values]
active = on_states(G, R, S, insertstep)</code></pre><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="@ref"><code>fit</code></a>: Main fitting function</li><li><a href="@ref"><code>simulator</code></a>: Model simulation</li><li><a href="@ref"><code>load_data</code></a>: Data loading</li><li><a href="@ref"><code>write_traces</code></a>: Trace generation</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../load_data/">« Data Loading</a><a class="docs-footer-nextpage" href="../analysis/">Analysis Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 6 February 2026 16:21">Friday 6 February 2026</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
